<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Helper de Receitas</title>
<style>
  body {
    font-family: Arial, sans-serif;
    display: flex;
    height: 100vh;
    margin: 0;
    background: #f4f4f4;
    color: #333;
  }
  #lista-receitas {
    flex: 1;
    background: #d5c4bc;
    overflow-y: auto;
    padding: 10px;
  }
  .receita-item {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    padding: 5px;
    border-bottom: 1px solid #b9a89e;
  }
  .receita-item img {
    width: 40px;
    height: 40px;
    object-fit: contain;
  }
  #detalhes {
    flex: 2;
    background: #2e231f;
    padding: 10px;
    overflow-y: auto;
  }
  .ingrediente {
    background: #3c2d28;
    padding: 5px;
    border-radius: 5px;
    margin-bottom: 5px;
  }
  .ingrediente-top {
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .ingrediente-top img {
    width: 32px;
    height: 32px;
    object-fit: contain;
  }
  .qtd-base {
    color: #ccc;
  }
  .nome {
    color: #fff;
    font-weight: bold;
  }
  .qtd-desejada {
    color: #ffcc00;
    font-size: 1.1em;
    font-weight: bold;
  }
  .ingrediente-valores {
    font-size: 0.85em;
    color: #aaa;
    margin-left: 38px;
  }
  #painel {
    flex: 1;
    background: #e6d4c8;
    padding: 10px;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  .painel-box {
    background: white;
    padding: 10px;
    border-radius: 8px;
  }
  input[type="number"] {
    width: 100%;
    padding: 5px;
  }
</style>
</head>
<body>

<div id="lista-receitas"></div>

<div id="detalhes">
  <h2 id="nome-receita"></h2>
  <div id="ingredientes-lista"></div>
</div>

<div id="painel">
  <div class="painel-box">
    Quantidade:
    <input type="number" id="qtd" min="1" max="100" value="1">
  </div>
  <div class="painel-box">Custo unitário: <span id="custo-unit">Ƀ 0</span></div>
  <div class="painel-box">Custo total: <span id="custo-total">Ƀ 0</span></div>
  <div class="painel-box">Preço de venda: <input type="number" id="preco-venda" value="0"></div>
  <div class="painel-box">Lucro: <span id="lucro">Ƀ 0</span></div>
</div>

<script>
let itens = [];
let receitas = [];
let receitaSelecionada = null;

fetch('itens.json')
  .then(res => res.json())
  .then(data => {
    itens = data;
    return fetch('receitas.json');
  })
  .then(res => res.json())
  .then(data => {
    receitas = data;
    carregarReceitas();
  });

function carregarReceitas() {
  const lista = document.getElementById('lista-receitas');
  lista.innerHTML = '';
  receitas.forEach(r => {
    const div = document.createElement('div');
    div.className = 'receita-item';
    div.innerHTML = `<img src="${r.sprite}" alt=""> <span>${r.level} (${r.cooldown}s) - ${r.nome}</span>`;
    div.onclick = () => selecionarReceita(r);
    lista.appendChild(div);
  });
}

function selecionarReceita(receita) {
  receitaSelecionada = receita;
  document.getElementById('nome-receita').innerText = receita.nome;
  const listaIng = document.getElementById('ingredientes-lista');
  listaIng.innerHTML = '';
  const qtd = parseInt(document.getElementById('qtd').value) || 1;
  receita.ingredientes.forEach(ing => {
    const itemInfo = itens.find(i => i.id === ing.id);
    if (!itemInfo) return;
    const div = document.createElement('div');
    div.className = 'ingrediente';
    div.innerHTML = `
      <div class="ingrediente-top">
        <img src="${itemInfo.sprite}" alt="">
        <span class="qtd-base">(${ing.quantidade})</span>
        <strong class="nome">${itemInfo.nome}</strong>
        <strong class="qtd-desejada">${ing.quantidade * qtd}</strong>
      </div>
      <div class="ingrediente-valores">
        Ƀ ${itemInfo.valor.toLocaleString('pt-BR')} = Ƀ ${(itemInfo.valor * ing.quantidade * qtd).toLocaleString('pt-BR')}
      </div>
    `;
    listaIng.appendChild(div);
  });
  atualizarCusto();
}

function atualizarCusto() {
  if (!receitaSelecionada) return;
  const qtd = parseInt(document.getElementById('qtd').value) || 1;
  let custoUnit = 0;
  receitaSelecionada.ingredientes.forEach(ing => {
    const itemInfo = itens.find(i => i.id === ing.id);
    if (itemInfo) {
      custoUnit += itemInfo.valor * ing.quantidade;
    }
  });
  const custoTotal = custoUnit * qtd;
  document.getElementById('custo-unit').innerText = "Ƀ " + custoUnit.toLocaleString('pt-BR');
  document.getElementById('custo-total').innerText = "Ƀ " + custoTotal.toLocaleString('pt-BR');

  const precoVendaUnit = parseInt(document.getElementById('preco-venda').value) || 0;
  const lucro = (precoVendaUnit - custoUnit) * qtd;
  document.getElementById('lucro').innerText = "Ƀ " + lucro.toLocaleString('pt-BR');

  selecionarReceita(receitaSelecionada);
}

document.getElementById('qtd').addEventListener('input', atualizarCusto);
document.getElementById('preco-venda').addEventListener('input', atualizarCusto);
</script>

</body>
</html>
