<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Calculadora de Receitas</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f0f0f0;
    color: #000;
    margin: 0;
    display: flex;
    height: 100vh;
  }
  body.dark {
    background: #1e1e1e;
    color: #fff;
  }
  .lista-receitas {
    border: 2px solid red;
    width: 200px;
    padding: 5px;
    overflow-y: auto;
  }
  .lista-receitas div {
    padding: 5px;
    cursor: pointer;
  }
  .lista-receitas div:hover {
    background: rgba(255,0,0,0.2);
  }
  .detalhes-receita {
    border: 2px solid blue;
    flex: 1;
    padding: 10px;
    overflow-y: auto;
  }
  .painel-direito {
    display: flex;
    flex-direction: column;
    gap: 10px;
    padding: 10px;
  }
  .painel-direito input {
    padding: 5px;
    font-size: 16px;
  }
  .ingrediente {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
  }
  .ingrediente img {
    width: 32px;
    height: 32px;
    margin-right: 10px;
    object-fit: contain;
  }
  .modo-btn {
    margin-top: auto;
    padding: 5px;
    cursor: pointer;
  }
</style>
</head>
<body>
  <div class="lista-receitas" id="listaReceitas"></div>
  <div class="detalhes-receita" id="detalhesReceita"></div>
  <div class="painel-direito">
    <input type="number" id="quantidade" min="1" max="100" value="1">
    <input type="text" id="valorTotal" placeholder="Valor total" readonly>
    <input type="number" id="valorVenda" placeholder="Valor venda">
    <input type="text" id="lucro" placeholder="Lucro" readonly>
    <button class="modo-btn" id="modoBtn">ðŸŒ™ Modo Noturno</button>
  </div>

<script>
let itens = [];
let receitas = [];
let receitaAtual = null;

Promise.all([
  fetch('itens.json').then(r => r.json()),
  fetch('receitas.json').then(r => r.json())
]).then(([dadosItens, dadosReceitas]) => {
  itens = dadosItens;
  receitas = dadosReceitas;
  carregarListaReceitas();
});

function carregarListaReceitas() {
  const lista = document.getElementById('listaReceitas');
  lista.innerHTML = '';
  receitas.forEach(r => {
    const div = document.createElement('div');
    div.textContent = r.nome;
    div.onclick = () => selecionarReceita(r);
    lista.appendChild(div);
  });
}

function selecionarReceita(receita) {
  receitaAtual = receita;
  const detalhes = document.getElementById('detalhesReceita');
  detalhes.innerHTML = `<h2>${receita.nome}</h2>`;
  
  receita.ingredientes.forEach(ing => {
    const itemInfo = itens.find(i => i.id === ing.id);
    if (!itemInfo) return;
    const precoUnit = itemInfo.valor;
    const qtdTotal = ing.quantidade * parseInt(document.getElementById('quantidade').value);
    const precoTotal = precoUnit * qtdTotal;

    const div = document.createElement('div');
    div.classList.add('ingrediente');
    div.innerHTML = `
      <img src="${itemInfo.sprite}" alt="">
      ${itemInfo.nome} - ${qtdTotal}x (${ing.quantidade} base) Ã— â‚¿${precoUnit} = â‚¿${precoTotal}
    `;
    detalhes.appendChild(div);
  });

  calcularTotais();
}

function calcularTotais() {
  if (!receitaAtual) return;
  let total = 0;
  receitaAtual.ingredientes.forEach(ing => {
    const itemInfo = itens.find(i => i.id === ing.id);
    if (itemInfo) {
      total += itemInfo.valor * ing.quantidade * parseInt(document.getElementById('quantidade').value);
    }
  });
  document.getElementById('valorTotal').value = `â‚¿${total}`;
  
  const venda = parseFloat(document.getElementById('valorVenda').value) || 0;
  document.getElementById('lucro').value = `â‚¿${venda - total}`;
}

document.getElementById('quantidade').addEventListener('input', () => selecionarReceita(receitaAtual));
document.getElementById('valorVenda').addEventListener('input', calcularTotais);

document.getElementById('modoBtn').addEventListener('click', () => {
  document.body.classList.toggle('dark');
});
</script>
</body>
</html>
