<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Helper de Receitas</title>
<style>
  body {
    font-family: Arial, sans-serif;
    display: flex;
    height: 100vh;
    margin: 0;
    background: #f4f4f4;
    color: #333;
    transition: background 0.3s, color 0.3s;
  }
  body.dark {
    background: #1e1e1e;
    color: #f4f4f4;
  }
  #lista-receitas {
    flex: 1;
    background: #ffdddd;
    overflow-y: auto;
    padding: 10px;
  }
  body.dark #lista-receitas {
    background: #662222;
  }
  .receita-item {
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    padding: 5px;
    border-bottom: 1px solid #ccc;
  }
  .receita-item img {
    width: 40px;
    height: 40px;
    object-fit: contain;
  }
  #detalhes {
    flex: 2;
    background: #ddeaff;
    padding: 10px;
  }
  body.dark #detalhes {
    background: #223355;
  }
  .ingrediente {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 3px 0;
  }
  .ingrediente img {
    width: 32px;
    height: 32px;
    object-fit: contain;
  }
  #painel {
    flex: 1;
    background: #fff0dd;
    padding: 10px;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  body.dark #painel {
    background: #553311;
  }
  .painel-box {
    background: white;
    padding: 10px;
    border-radius: 8px;
  }
  body.dark .painel-box {
    background: #333;
  }
  input[type="number"] {
    width: 100%;
    padding: 5px;
  }
  button {
    padding: 5px 10px;
    cursor: pointer;
  }
</style>
</head>
<body>

<div id="lista-receitas"></div>

<div id="detalhes">
  <h2 id="nome-receita"></h2>
  <div id="ingredientes-lista"></div>
</div>

<div id="painel">
  <div class="painel-box">
    Quantidade:
    <input type="number" id="qtd" min="1" max="100" value="1">
  </div>
  <div class="painel-box">Custo total: <span id="custo-total">Ƀ 0</span></div>
  <div class="painel-box">Preço de venda: <input type="number" id="preco-venda" value="0"></div>
  <div class="painel-box">Lucro: <span id="lucro">Ƀ 0</span></div>
  <button id="toggle-dark">Alternar modo noturno</button>
</div>

<script>
let itens = [];
let receitas = [];
let receitaSelecionada = null;

fetch('itens.json')
  .then(res => res.json())
  .then(data => {
    itens = data;
    return fetch('receitas.json');
  })
  .then(res => res.json())
  .then(data => {
    receitas = data;
    carregarReceitas();
  });

function carregarReceitas() {
  const lista = document.getElementById('lista-receitas');
  lista.innerHTML = '';
  receitas.forEach(r => {
    const div = document.createElement('div');
    div.className = 'receita-item';
    div.innerHTML = `<img src="${r.sprite}" alt=""> <span>${r.nome}</span>`;
    div.onclick = () => selecionarReceita(r);
    lista.appendChild(div);
  });
}

function selecionarReceita(receita) {
  receitaSelecionada = receita;
  document.getElementById('nome-receita').innerText = receita.nome;
  const listaIng = document.getElementById('ingredientes-lista');
  listaIng.innerHTML = '';
  receita.ingredientes.forEach(ing => {
    const itemInfo = itens.find(i => i.id === ing.id);
    if (!itemInfo) return;
    const div = document.createElement('div');
    div.className = 'ingrediente';
    div.innerHTML = `
      <img src="${itemInfo.sprite}" alt="">
      <span>${itemInfo.nome} - ${ing.quantidade} base</span>
    `;
    listaIng.appendChild(div);
  });
  atualizarCusto();
}

function atualizarCusto() {
  if (!receitaSelecionada) return;
  const qtd = parseInt(document.getElementById('qtd').value) || 1;
  let custo = 0;
  receitaSelecionada.ingredientes.forEach(ing => {
    const itemInfo = itens.find(i => i.id === ing.id);
    if (itemInfo) {
      custo += itemInfo.valor * ing.quantidade * qtd;
    }
  });
  document.getElementById('custo-total').innerText = "Ƀ " + custo.toLocaleString('pt-BR');
  const precoVenda = parseInt(document.getElementById('preco-venda').value) || 0;
  const lucro = precoVenda - custo;
  document.getElementById('lucro').innerText = "Ƀ " + lucro.toLocaleString('pt-BR');
}

document.getElementById('qtd').addEventListener('input', atualizarCusto);
document.getElementById('preco-venda').addEventListener('input', atualizarCusto);

document.getElementById('toggle-dark').addEventListener('click', () => {
  document.body.classList.toggle('dark');
});
</script>

</body>
</html>
